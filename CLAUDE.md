# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

**Earnings-Decoded** is a company business analysis and earnings interpretation tool. It generates three types of reports in Chinese (Simplified): è´¢æŠ¥è§£è¯» (earnings breakdown), è´¢æŠ¥å‰ç» (earnings preview), and ä¼ä¸šç»è¥åˆ†æ (four-perspective business analysis). Part of the AIDreamWorks workspace.

## Workspace Conventions

- Financial reports and analysis are always in **Chinese (Simplified)**
- User timezone: **KST (Asia/Seoul)**

## Setup & Commands

```bash
npm install                                          # one-time: installs puppeteer-core for PDF generation
node src/generate-pdf.js reports/AAPL-2025-Q1.html   # generate PDF from HTML report (accepts multiple files)
npm run open-latest                                  # open the most recently modified report in browser
```

PDF generation requires Google Chrome at `/Applications/Google Chrome.app`. If Chrome print fails, `generate-pdf.js` falls back to a full-page screenshot converted via `sips`.

## Architecture

This is a **Claude Code-native tool** â€” there is no application runtime. Claude Code itself is the "app": it searches the web, assembles data, and writes self-contained HTML report files. The codebase is intentionally minimal:

```
src/
  template.html            # HTML/CSS template for è´¢æŠ¥è§£è¯» and è´¢æŠ¥å‰ç» reports
  template-analysis.html   # HTML/CSS template for ä¼ä¸šç»è¥åˆ†æ reports
  generate-pdf.js          # Node script: puppeteer-core â†’ Chrome headless â†’ PDF
reports/                   # Output directory (gitignored). Naming conventions:
                           #   [TICKER]-[YYYY]-[Quarter].html          (è´¢æŠ¥è§£è¯»)
                           #   [TICKER]-[YYYY]-[Quarter]-preview.html  (è´¢æŠ¥å‰ç»)
                           #   [TICKER]-analysis-[YYYY]-[MM].html      (ä¼ä¸šç»è¥åˆ†æ)
```

Templates use `{{PLACEHOLDER}}` tokens in `<title>` for reference only â€” reports are **not** generated by template substitution. Instead, Claude reads the template to absorb the CSS/structure, then writes a complete standalone HTML file per report.

---

## Workflow Router

When the user provides input, determine which workflow to trigger:

| User Input | Workflow | Report Type |
|---|---|---|
| `"åˆ†æ [company]"` / `"[company] åˆ†æ"` / `"analyze [company]"` | ä¼ä¸šç»è¥åˆ†æ | Four-perspective business analysis |
| `"å‰ç» [company]"` / `"[company] å‰ç»"` / `"[company] preview"` | è´¢æŠ¥å‰ç» | Pre-earnings preview |
| Just a company name (no qualifier) | è´¢æŠ¥è§£è¯» (default) | Earnings report breakdown |

**Disambiguation**: If the user says just a company name with no other context, default to è´¢æŠ¥è§£è¯». However, if the most recent earnings have already been covered OR the next earnings date is within ~3 weeks, **ask** whether they want è´¢æŠ¥è§£è¯», è´¢æŠ¥å‰ç», or ä¼ä¸šç»è¥åˆ†æ.

---

## Workflow: Earnings Report Translation

When the user provides a **company name** (e.g., "Apple", "CPNG", "Microsoft"), follow this workflow:

### Step 1 â€” Search for Latest Earnings Data

Use **WebSearch** to find the latest quarterly earnings. Run these searches in parallel:

1. `"[Company] latest quarterly earnings results [current year]"` â€” for the earnings release
2. `"[Company] earnings call highlights [current year]"` â€” for management commentary and guidance
3. `"[Company] revenue segments breakdown [quarter] [year]"` â€” for segment data

If the company has a well-known ticker (e.g., AAPL, CPNG, MSFT), use the ticker in searches for better results.

### Step 2 â€” Fetch Detailed Data

Use **WebFetch** on the most relevant results (earnings press releases, financial news articles, analyst summaries) to extract:

- **Revenue**: total, by segment, by geography (actual vs. estimate)
- **EPS**: GAAP and non-GAAP (actual vs. estimate)
- **Net income / Operating income**
- **Margins**: gross, operating, net (and YoY/QoQ changes)
- **Key operating metrics**: users, subscribers, units shipped, etc.
- **Forward guidance**: next quarter and full year outlook
- **Management commentary**: key quotes on strategy, risks, opportunities
- **Analyst consensus**: how results compared to Wall Street expectations

### Step 3 â€” Translate & Analyze

Transform the raw data into plain-language Chinese analysis. Follow these translation guidelines:

#### Financial Jargon Translation Table

| English Term | Chinese Translation | Plain Explanation |
|---|---|---|
| Revenue / Net Sales | è¥æ”¶ / å‡€é”€å”®é¢ | å…¬å¸èµšäº†å¤šå°‘é’±ï¼ˆå–è´§/æœåŠ¡æ”¶å…¥ï¼‰ |
| EPS (Earnings Per Share) | æ¯è‚¡æ”¶ç›Š | æ¯æŒæœ‰ä¸€è‚¡èƒ½åˆ†åˆ°å¤šå°‘åˆ©æ¶¦ |
| Gross Margin | æ¯›åˆ©ç‡ | æ‰£æ‰æˆæœ¬åè¿˜å‰©å¤šå°‘åˆ©æ¶¦ï¼ˆç™¾åˆ†æ¯”ï¼‰ |
| Operating Margin | è¥ä¸šåˆ©æ¶¦ç‡ | æ‰£æ‰è¿è¥è´¹ç”¨åçš„åˆ©æ¶¦å æ¯” |
| Net Income | å‡€åˆ©æ¶¦ | æœ€ç»ˆåˆ°æ‰‹çš„åˆ©æ¶¦ |
| YoY (Year-over-Year) | åŒæ¯” | å’Œå»å¹´åŒæœŸæ¯” |
| QoQ (Quarter-over-Quarter) | ç¯æ¯” | å’Œä¸Šä¸ªå­£åº¦æ¯” |
| Beat / Miss | è¶…é¢„æœŸ / ä¸åŠé¢„æœŸ | æ¯”åå°”è¡—é¢„æœŸå¥½/å·® |
| Guidance | ä¸šç»©æŒ‡å¼• | å…¬å¸å¯¹ä¸‹ä¸ªå­£åº¦/å…¨å¹´çš„ä¸šç»©é¢„æµ‹ |
| Free Cash Flow | è‡ªç”±ç°é‡‘æµ | å…¬å¸è¿è¥åçœŸæ­£å¯è‡ªç”±æ”¯é…çš„ç°é‡‘ |
| EBITDA | æ¯ç¨æŠ˜æ—§æ‘Šé”€å‰åˆ©æ¶¦ | è¡¡é‡ç»è¥æ•ˆç‡çš„åˆ©æ¶¦æŒ‡æ ‡ |
| Capex | èµ„æœ¬æ”¯å‡º | å…¬å¸èŠ±åœ¨è®¾å¤‡ã€å»ºè®¾ç­‰é•¿æœŸèµ„äº§ä¸Šçš„é’± |
| Share Buyback | è‚¡ç¥¨å›è´­ | å…¬å¸ç”¨åˆ©æ¶¦ä¹°å›è‡ªå®¶è‚¡ç¥¨ |
| Consensus Estimate | å¸‚åœºä¸€è‡´é¢„æœŸ | åˆ†æå¸ˆä»¬çš„å¹³å‡é¢„æµ‹å€¼ |
| Segment | ä¸šåŠ¡æ¿å— | å…¬å¸ä¸åŒçš„ä¸šåŠ¡åˆ†æ”¯ |
| Headwind / Tailwind | é€†é£ / é¡ºé£ | ä¸åˆ©å› ç´  / æœ‰åˆ©å› ç´  |
| Macro | å®è§‚ç¯å¢ƒ | æ•´ä½“ç»æµå¤§ç¯å¢ƒ |

#### Writing Style

- **Tone**: åƒç»™ä¸€ä¸ªèªæ˜ä½†éé‡‘èä¸“ä¸šçš„æœ‹å‹è§£é‡Šï¼ˆsmart friend, not a financial professionalï¼‰
- **Numbers**: Always include both absolute values and percentage changes
- **Comparisons**: Always show actual vs. estimate where available
- **Context**: Explain *why* a metric matters, not just *what* it is
- **Verdict**: Each section should end with a brief assessment (positive/neutral/negative)
- Use âœ… for beats/positives, âš ï¸ for misses/concerns, ğŸ“Š for neutral data points

### Step 4 â€” Generate HTML Report

Read the template from `src/template.html` and use it as a reference for styling and structure. Generate a complete, self-contained HTML file with these sections:

1. **å…¬å¸æ¦‚è§ˆ** â€” Company name (Chinese + English), ticker, exchange, report period, report date, stock price at close. For companies with non-calendar fiscal years (e.g., Alibaba ends March), display the period as "YYYYå¹´Mæœˆå­£åº¦ï¼ˆFY20XX QXï¼‰" to prioritize readability â€” e.g., "2025å¹´9æœˆå­£åº¦ï¼ˆFY2026 Q2ï¼‰" instead of "FY2026 Q2ï¼ˆ2025å¹´7-9æœˆï¼‰"
2. **æ ¸å¿ƒæŒ‡æ ‡** â€” Metric cards showing: Revenue, EPS, Net Income, Gross Margin, Operating Margin, Free Cash Flow. Each card shows actual value, estimate, beat/miss status, and YoY change
3. **æ”¶å…¥åˆ†æ** â€” Revenue breakdown by segment and/or geography in table format with YoY changes
4. **ä¸šç»©äº®ç‚¹ä¸ä¸è¶³** â€” Bullet points of key beats (âœ…) and misses (âš ï¸) with plain-language explanation
5. **å‰ç»æŒ‡å¼•** â€” Management's guidance for next quarter and full year, compared to consensus
6. **é£é™©æç¤º** â€” Key risks mentioned in the call or identified from data
7. **æŠ•èµ„è€…æ€»ç»“ ("So What?")** â€” 2-3 paragraph plain-language summary of what this earnings report means. Include an overall assessment badge: ğŸŸ¢ ç§¯æ / ğŸŸ¡ ä¸­æ€§ / ğŸ”´ æ¶ˆæ

### Step 5 â€” Save & Open

1. Write the HTML file to: `reports/[TICKER]-[YYYY]-[Quarter].html`
   - Example: `reports/AAPL-2025-Q1.html`
   - If ticker is unknown, use the company name: `reports/Coupang-2025-Q1.html`
2. Generate PDF: `node src/generate-pdf.js reports/[filename].html`
3. Open HTML in Chrome: `open reports/[filename].html`

---

## Workflow: è´¢æŠ¥å‰ç» (Earnings Preview)

When the user triggers an earnings preview, follow this workflow to generate a forward-looking pre-earnings report.

### Trigger

- User says **"å‰ç» [company]"** or **"[company] å‰ç»"** or **"[company] preview"**
- If the user says just a company name with no other context, and the most recent earnings have already been covered OR the next earnings date is within ~3 weeks, **ask** whether they want è´¢æŠ¥è§£è¯» (post-earnings) or è´¢æŠ¥å‰ç» (pre-earnings preview)

### Step 1 â€” Search for Upcoming Earnings & Estimates

Use **WebSearch** to gather pre-earnings data. Run these searches in parallel:

1. `"[Company] upcoming earnings date [year]"` â€” confirm earnings date and time
2. `"[Company] earnings preview estimates [quarter] [year]"` â€” consensus estimates
3. `"[Company] analyst expectations [quarter] [year]"` â€” what analysts are watching

If the company has a well-known ticker (e.g., AAPL, CPNG, MSFT), use the ticker in searches for better results.

### Step 2 â€” Fetch Detailed Data

Use **WebFetch** on the most relevant results (analyst previews, financial news, estimate compilations) to extract:

- **Upcoming earnings date & time** (and whether it's before/after market)
- **Consensus estimates**: Revenue, EPS (and range of high/low estimates)
- **Previous quarter recap**: actual vs. estimate results, key takeaways
- **Historical beat/miss track record** (last 4-8 quarters)
- **Key metrics to watch** this quarter (specific to the company/industry)
- **Recent news/events** that may impact results (product launches, macro shifts, regulatory changes)
- **Analyst sentiment**: recent upgrades/downgrades, price target changes

### Step 3 â€” Translate & Analyze

Use the same **Financial Jargon Translation Table** and **Writing Style** guidelines from the Earnings Report Translation workflow above.

Additional preview-specific guidelines:
- Use ğŸ” for key things to watch
- Use ğŸ“ˆ for positive expectations, ğŸ“‰ for negative expectations
- Use ğŸ† for historical beats, âŒ for historical misses in the track record table
- **Tone**: Forward-looking and analytical â€” "å¸‚åœºé¢„æœŸ..." / "åˆ†æå¸ˆå…³æ³¨..." / "å€¼å¾—ç•™æ„çš„æ˜¯..."
- **No verdicts on actual performance** â€” this is a preview, not a post-mortem

### Step 4 â€” Generate HTML Preview Report

Read the template from `src/template.html` and use it as a reference for styling and structure. Generate a complete, self-contained HTML file with the following **preview-specific** modifications and sections:

#### Styling Differences from Earnings Report

- **Header gradient**: Use a blue-tinted gradient (`linear-gradient(135deg, #1a365d 0%, #2a4a7f 100%)`) instead of the dark default, to visually distinguish previews
- **Header subtitle**: Says "è´¢æŠ¥å‰ç»" instead of "è´¢æŠ¥è§£è¯»"
- **Metric cards**: Use a blue left border (`border-left-color: #4299e1`) with a "preview" style class for consensus estimates, since there are no beat/miss results yet. Add CSS: `.metric-card.preview { border-left-color: #4299e1; }` and `.metric-badge.preview { background: #ebf8ff; color: #2b6cb0; }`

#### Report Sections

1. **å…¬å¸æ¦‚è§ˆ** â€” Company name (Chinese + English), ticker, exchange, upcoming earnings date & time (æ ‡æ³¨ç›˜å‰/ç›˜å), current stock price. Use the same fiscal year display conventions as the earnings report.
2. **å¸‚åœºé¢„æœŸ** â€” Metric cards showing consensus estimates for: Revenue, EPS, and other key metrics. Each card shows the consensus estimate, the range of estimates (high/low), and YoY change vs. last year's same quarter. Use the `preview` card style (blue border) with badge text "ğŸ“Š å¸‚åœºé¢„æœŸ".
3. **ä¸Šå­£å›é¡¾** â€” Quick recap of last quarter's results. Show key metrics (Revenue, EPS) with actual vs. estimate and beat/miss status. 2-3 bullet points on key takeaways from last quarter.
4. **æœ¬å­£çœ‹ç‚¹** â€” Bullet list (using `highlights-list` style) of 4-6 key things to watch this quarter. Each item should explain *why* it matters. Use ğŸ” prefix.
5. **å†å²è¡¨ç°** â€” Table showing beat/miss track record for the last 4-8 quarters. Columns: å­£åº¦, è¥æ”¶(å®é™…), è¥æ”¶(é¢„æœŸ), EPS(å®é™…), EPS(é¢„æœŸ), ç»“æœ. Use ğŸ†/âŒ in the ç»“æœ column.
6. **è¿‘æœŸåŠ¨æ€** â€” Recent news, analyst actions, and events affecting outlook. Use `risk-item` style blocks (but with blue/info color: `border-left-color: #4299e1; background: #ebf8ff;`). 3-5 items.
7. **æŠ•èµ„è€…å…³æ³¨ç‚¹** â€” 2-3 paragraph plain-language summary of what matters most going into this earnings report. No overall assessment badge (since results haven't been released), but highlight the key question investors should focus on.

### Step 5 â€” Save & Open

1. Write the HTML file to: `reports/[TICKER]-[YYYY]-[Quarter]-preview.html`
   - Example: `reports/AAPL-2025-Q2-preview.html`
   - If ticker is unknown, use the company name: `reports/Coupang-2025-Q2-preview.html`
2. Generate PDF: `node src/generate-pdf.js reports/[filename].html`
3. Open HTML in Chrome: `open reports/[filename].html`

---

## Workflow: ä¼ä¸šç»è¥åˆ†æ (Company Business Analysis)

When the user triggers a business analysis (via "åˆ†æ", "analyze", etc.), follow this workflow to generate a comprehensive four-perspective analysis report.

### Trigger

- User says **"åˆ†æ [company]"** or **"[company] åˆ†æ"** or **"analyze [company]"**

### Step 1 â€” Search (Parallel WebSearches)

#### Phase 1 â€” Baseline (6 parallel searches)

Use **WebSearch** to gather comprehensive data. Run all 6 searches in parallel:

1. `"[Company] latest quarterly earnings results [year]"` â€” financial performance
2. `"[Company] business model revenue segments [year]"` â€” how it makes money
3. `"[Company] competitive advantage moat analysis [year]"` â€” æŠ¤åŸæ²³ï¼ˆBuffett lensï¼‰
4. `"[Company] ROE ROIC free cash flow 10 year history"` â€” é•¿æœŸè´¢åŠ¡ä½“è´¨ï¼ˆBuffett lensï¼‰
5. `"[Company] strategy CEO capital allocation [year]"` â€” management + direction
6. `"[Company] intrinsic value valuation analyst price target [year]"` â€” ä¼°å€¼ä¸å®‰å…¨è¾¹é™…
7. `"[Company] analyst consensus rating bull bear case [year]"` â€” å¸‚åœºå·²çŸ¥å…±è¯† vs åˆ†æ­§

If the company has a well-known ticker (e.g., AAPL, CPNG, BABA), use the ticker in searches for better results.

#### Phase 2 â€” Targeted Deep Dives (after Phase 1 fetch)

Based on Phase 1 results, run additional searches as needed to fill gaps:

- **Observer (å·´è²ç‰¹å•†ä¸šåˆ†æç»´åº¦)**: moat/competitive advantage type, ROE/ROIC history, management capital allocation track record, pricing power evidence, debt vs equity structure
- **Strategist**: industry trends, strategic initiatives, partnerships/acquisitions
- **CEO**: CEO interviews, organizational challenges, R&D pipeline
- **Investment (å·´è²ç‰¹æŠ•èµ„ç»´åº¦)**: owner earnings/FCF yield, intrinsic value estimates, margin of safety, insider ownership, buyback history, book value growth
- **Market Pricing (å¸‚åœºå®šä»·åˆ†æ)**: implied growth rate from current valuation, analyst consensus spread (how much bulls/bears disagree), institutional ownership changes, short interest, recent insider buying/selling

### Step 2 â€” Fetch & Extract

Use **WebFetch** on the most relevant results from Phase 1 and Phase 2 to extract detailed data for each perspective:

- **Company basics**: founding year, HQ, CEO, employee count, market cap, core business
- **Financial metrics**: ROE (10-year), ROIC, FCF, debt/equity ratio, gross margin trends, owner earnings
- **Moat assessment**: brand strength, network effects, switching costs, cost advantages, economies of scale
- **Management**: capital allocation track record (buybacks, dividends, reinvestment returns), insider ownership, integrity
- **Competitive landscape**: market share vs competitors, moat comparison
- **Strategic position**: industry trends, current bets, risks and opportunities
- **Valuation**: P/E, P/FCF, EV/EBITDA (current vs historical vs industry), intrinsic value estimates, analyst price targets
- **Market pricing consensus**: analyst rating distribution (buy/hold/sell counts), bull vs bear thesis summaries, implied growth rate baked into current P/E, institutional ownership trends, insider transactions (last 6 months)

**Live Data Verification**: Before proceeding, run a final search to verify the current stock price, market cap, and global market cap ranking. Do NOT rely on article data for these â€” they go stale within days. Any superlative claims ("å…¨çƒç¬¬ä¸€", "æœ€å¤§") must be confirmed against current data.

### Step 3 â€” Analyze & Write

Transform raw data into the four-perspective analysis. Each perspective has a distinct voice and analytical lens:

#### Perspective Voices

- **ğŸ” Observer (å·´è²ç‰¹å¼å•†ä¸šåˆ†æ)**:
  - Core question chain: è¿™é—¨ç”Ÿæ„æˆ‘èƒ½çœ‹æ‡‚å—ï¼Ÿâ†’ å®ƒæœ‰æŒä¹…çš„æŠ¤åŸæ²³å—ï¼Ÿâ†’ ç®¡ç†å±‚æ˜¯å¦è¯šå®èƒ½å¹²ï¼Ÿâ†’ é•¿æœŸç»æµç‰¹å¾å¦‚ä½•ï¼Ÿ
  - Tone: æ²‰ç¨³ã€ç©¿é€è¡¨è±¡
  - Voice: "è¿™é—¨ç”Ÿæ„çš„æœ¬è´¨æ˜¯..." / "æŠ¤åŸæ²³çš„è€ä¹…æ€§åœ¨äº..." / "ç®¡ç†å±‚ç”¨è‚¡ä¸œçš„é’±æ˜¯å¦æ˜æ™º..."

- **ğŸ§­ Strategist (æˆ˜ç•¥å®¶)**:
  - Framework-driven, industry-focused
  - Voice: "æ ¸å¿ƒæˆ˜ç•¥é—®é¢˜æ˜¯..." / "ä»è¡Œä¸šè¶‹åŠ¿æ¥çœ‹..." / "ç«äº‰æ ¼å±€æ­£åœ¨..."

- **ğŸ‘” CEO (CEOè§†è§’)**:
  - Action-oriented, priority-driven
  - Voice: "ä¸Šä»»ç¬¬ä¸€ä»¶äº‹..." / "12ä¸ªæœˆå†…å¿…é¡»..." / "ä¸‰å¹´åè¿™å®¶å…¬å¸åº”è¯¥..."

- **ğŸ’° Investment Advisor (å·´è²ç‰¹å¼æŠ•èµ„è¯„ä¼°)**:
  - Value-focused, long-term holder perspective (not trader perspective)
  - **Core analytical framework**: Good company â‰  good investment. The stock price already reflects what every smart analyst on Wall Street can see. The key question is NOT "is this a good company?" but "is the **price** right for what this company will earn over the next decade?"
  - Must answer: (1) What does the current price **imply** the market already believes? (2) What might the market be **wrong** about? (3) Is there enough **margin of safety** if we're wrong too?
  - Voice: "å¦‚æœæˆ‘è¦ä¹°ä¸‹æ•´å®¶å…¬å¸..." / "ä»¥æ‰€æœ‰è€…æ”¶ç›Šæ¥è¡¡é‡..." / "å®‰å…¨è¾¹é™…æ˜¯å¦è¶³å¤Ÿ..." / "åå¹´åè¿™å®¶å…¬å¸ä¼šåœ¨å“ªé‡Œ..." / "å¸‚åœºå·²ç»ä¸ºè¿™ä¸ªæ•…äº‹å®šä»·äº†â€”â€”é—®é¢˜æ˜¯å®ƒå®šå¯¹äº†å—ï¼Ÿ"

Use the **Financial Jargon Translation Table** and **Strategic Jargon Translation Table** below for consistent terminology. Follow the same **Writing Style** guidelines as the earnings workflow.

### Step 4 â€” Generate HTML Analysis Report

Read the template from `src/template-analysis.html` and use it as a reference for styling and structure. Generate a complete, self-contained HTML file with these sections:

1. **ä¼ä¸šç”»åƒ** â€” Company name (Chinese + English), ticker, exchange, key facts table (Founded, HQ, CEO, Market Cap, etc.), one-paragraph plain-language description of what the company does
2. **ğŸ” è§‚å¯Ÿè€…ï¼šè¿™æ˜¯ä¸€é—¨å¥½ç”Ÿæ„å—ï¼Ÿ** â€” Buffett-style business analysis:
   - 2a. ç”Ÿæ„æœ¬è´¨ â€” ä¸€å¥è¯è¯´æ¸…æ¥šé ä»€ä¹ˆèµšé’±ï¼Œå•†ä¸šæ¨¡å¼æ˜¯å¦ç®€å•å¯ç†è§£
   - 2b. æŠ¤åŸæ²³åˆ†æ â€” é€ä¸€è¯„ä¼°äº”ç§æŠ¤åŸæ²³ï¼ˆå“ç‰Œã€ç½‘ç»œæ•ˆåº”ã€è½¬æ¢æˆæœ¬ã€æˆæœ¬ä¼˜åŠ¿ã€è§„æ¨¡æ•ˆåº”ï¼‰ï¼Œç”¨ ğŸŸ¢å¼º/ğŸŸ¡ä¸­/ğŸ”´å¼± æ ‡æ³¨
   - 2c. è´¢åŠ¡ä½“è´¨ â€” Metric cards: ROE (10å¹´)ã€ROICã€è‡ªç”±ç°é‡‘æµã€å€ºåŠ¡/è‚¡æƒæ¯”ã€æ¯›åˆ©ç‡è¶‹åŠ¿
   - 2d. ç®¡ç†å±‚è¯„ä¼° â€” èµ„æœ¬é…ç½®èƒ½åŠ›ã€ç®¡ç†å±‚æŒè‚¡ã€è¯šä¿¡è®°å½•
   - 2e. ç«äº‰æ ¼å±€ â€” Comparison table vs 2-3 competitors on moat metrics
   - 2f. è§‚å¯Ÿè€…å°ç»“ â€” Assessment badge: ğŸŸ¢ å¥½ç”Ÿæ„ / ğŸŸ¡ ä¸€èˆ¬ / ğŸ”´ å·®ç”Ÿæ„
3. **ğŸ§­ æˆ˜ç•¥å®¶ï¼šå‘å±•æ–¹å‘** â€” Strategic analysis:
   - 3a. è¡Œä¸šè¶‹åŠ¿ â€” 3-5 key trends with company implications (use info-block style)
   - 3b. æˆ˜ç•¥å®šä½ â€” Two-column layout: æˆ˜ç•¥ä¼˜åŠ¿ vs æˆ˜ç•¥é£é™©
   - 3c. æˆ˜ç•¥å»ºè®® â€” 3-5 concrete recommendations
   - 3d. æˆ˜ç•¥åˆ†æå°ç»“
4. **ğŸ‘” CEOè§†è§’ï¼šè¡ŒåŠ¨è®¡åˆ’** â€” Action plan:
   - 4a. å½“åŠ¡ä¹‹æ€¥ â€” Top 3 priorities as priority cards (urgent/important/strategic)
   - 4b. ä¸‰å¹´è¡ŒåŠ¨è®¡åˆ’ â€” Year 1/2/3 milestones using timeline layout
   - 4c. äº”å¹´æ„¿æ™¯ â€” Long-term vision
   - 4d. CEOå°ç»“
5. **ğŸ’° æŠ•èµ„é¡¾é—®ï¼šå·´è²ç‰¹å¼æŠ•èµ„è¯„ä¼°** â€” Investment assessment:
   - 5a. å†…åœ¨ä»·å€¼ â€” Owner Earnings, FCF Yield, Margin of Safety metric cards
   - 5b. ä¼°å€¼é”šç‚¹ â€” P/E, P/FCF, EV/EBITDA table (current vs historical vs industry)
   - 5c. å¸‚åœºå®šä»·åˆ†æ ("èªæ˜é’±å·²ç»çŸ¥é“ä»€ä¹ˆï¼Ÿ") â€” **This is the critical "priced in" section.** Structure:
     - **å¸‚åœºå…±è¯†** â€” Analyst rating distribution (e.g., 28 Buy / 10 Hold / 2 Sell), consensus price target vs current price, what the bull and bear cases are. This is what every Wall Street analyst already sees.
     - **éšå«é¢„æœŸ** â€” Reverse-engineer what growth rate the current P/E implies (e.g., "å½“å‰35å€å¸‚ç›ˆç‡éšå«æœªæ¥5å¹´æ¯å¹´~18%çš„ç›ˆåˆ©å¢é•¿"). Compare this implied growth to the company's actual historical growth rate â€” is the market being too optimistic or too conservative?
     - **å¸‚åœºå¯èƒ½ä½ä¼°çš„** (ğŸ“ˆ) â€” 2-3 factors NOT fully priced in that could drive upside. These should be specific, non-obvious insights (not "revenue could grow" but "management's $2B buyback at current FCF yield implies 4% annual return floor that analysts aren't modeling")
     - **å¸‚åœºå¯èƒ½å¿½è§†çš„é£é™©** (ğŸ“‰) â€” 2-3 underappreciated risks the consensus is overlooking
     - **èªæ˜é’±åŠ¨å‘** â€” Recent insider buying/selling, major institutional ownership changes, short interest trends. These are signals of what informed investors are actually doing with their money.
   - 5d. åå¹´å±•æœ› â€” Compounding logic, projected market cap range
   - 5e. å‚¬åŒ–å‰‚ä¸é£é™© â€” Green catalyst blocks + orange risk blocks (long-term holder perspective)
   - 5f. æŠ•èµ„ç»“è®º â€” ğŸŸ¢ å€¼å¾—æ‹¥æœ‰ / ğŸŸ¡ è§‚å¯Ÿç­‰å¾… / ğŸ”´ ä¸ç¬¦åˆæ ‡å‡† + "å·´è²ç‰¹ä¼šä¹°å—ï¼Ÿ" one-sentence judgment + **ä¹°å…¥æ—¶æœºå»ºè®®**: explicitly state at what price/valuation level this becomes attractive (e.g., "è‹¥å›è°ƒè‡³28å€å¸‚ç›ˆç‡ä»¥ä¸‹ï¼ˆçº¦$XXï¼‰ï¼Œå®‰å…¨è¾¹é™…è¶³å¤Ÿ")
6. **ğŸ“‹ å››ç»´æ€»ç»“** â€” Synthesis dashboard:
   - 2x2 grid: each cell = perspective name + verdict + 1-sentence rationale
   - 1-2 paragraph synthesis weaving all four perspectives together
7. **Footer**

### Step 5 â€” Save & Open

1. Write the HTML file to: `reports/[TICKER]-analysis-[YYYY]-[MM].html`
   - Example: `reports/BABA-analysis-2026-02.html`
   - If ticker is unknown, use the company name: `reports/Coupang-analysis-2026-02.html`
   - Uses year-month (not quarter) since this analysis is not tied to a specific earnings period
2. Generate PDF: `node src/generate-pdf.js reports/[filename].html`
3. Open HTML in Chrome: `open reports/[filename].html`

---

#### Strategic Jargon Translation Table

This table extends the Financial Jargon Translation Table above with terms specific to business analysis:

| English Term | Chinese Translation | Plain Explanation |
|---|---|---|
| **å·´è²ç‰¹æ ¸å¿ƒæ¦‚å¿µ** | | |
| Moat | æŠ¤åŸæ²³ | åˆ«äººå¾ˆéš¾å¤åˆ¶çš„æ ¸å¿ƒèƒ½åŠ›ï¼ˆå·´è²ç‰¹æœ€çœ‹é‡çš„ä¸œè¥¿ï¼‰ |
| Margin of Safety | å®‰å…¨è¾¹é™… | ç”¨æ‰“æŠ˜ä»·ä¹°å…¥ï¼Œç•™è¶³çŠ¯é”™ç©ºé—´ |
| Owner Earnings | æ‰€æœ‰è€…æ”¶ç›Š | è‚¡ä¸œçœŸæ­£èƒ½æ‹¿åˆ°æ‰‹çš„é’±ï¼ˆæ¯”å‡€åˆ©æ¶¦æ›´çœŸå®ï¼‰ |
| Intrinsic Value | å†…åœ¨ä»·å€¼ | ä¸€å®¶å…¬å¸çœŸæ­£å€¼å¤šå°‘é’±ï¼ˆä¸æ˜¯è‚¡ä»·ï¼‰ |
| Circle of Competence | èƒ½åŠ›åœˆ | åªæŠ•è‡ªå·±çœ‹å¾—æ‡‚çš„ç”Ÿæ„ |
| Mr. Market | å¸‚åœºå…ˆç”Ÿ | å¸‚åœºçŸ­æœŸæ˜¯æŠ•ç¥¨æœºï¼Œé•¿æœŸæ˜¯ç§°é‡æœº |
| Pricing Power | å®šä»·æƒ | æ¶¨ä»·å®¢æˆ·ä¹Ÿä¸èµ°â€”â€”æœ€å¥½çš„æŠ¤åŸæ²³æŒ‡æ ‡ |
| Capital Allocation | èµ„æœ¬é…ç½® | ç®¡ç†å±‚æ€ä¹ˆèŠ±è‚¡ä¸œçš„é’±ï¼ˆæœ€è€ƒéªŒCEOèƒ½åŠ›ï¼‰ |
| Float | æµ®å­˜é‡‘ | å…ˆæ”¶é’±åä»˜é’±çš„å•†ä¸šæ¨¡å¼ï¼ˆå¦‚ä¿é™©ï¼‰ |
| Compounding | å¤åˆ© | åˆ©æ»šåˆ©ï¼Œæ—¶é—´è¶Šé•¿æ•ˆæœè¶ŠæƒŠäºº |
| **æˆ˜ç•¥åˆ†ææ¦‚å¿µ** | | |
| TAM | æ€»å¯å¯»å€å¸‚åœº | å¸‚åœºå¤©èŠ±æ¿æœ‰å¤šé«˜ |
| ROIC | æŠ•å…¥èµ„æœ¬å›æŠ¥ç‡ | æ¯æŠ•ä¸€å—é’±èƒ½èµšå›å¤šå°‘ |
| ROE | å‡€èµ„äº§æ”¶ç›Šç‡ | è‚¡ä¸œæ¯ä¸€å—é’±èµšäº†å¤šå°‘ï¼ˆå·´è²ç‰¹è¦æ±‚>15%ï¼‰ |
| Market Share | å¸‚åœºä»½é¢ | åœ¨æ•´ä¸ªå¸‚åœºé‡Œå å¤šå¤§ä¸€å—é¥¼ |
| Network Effect | ç½‘ç»œæ•ˆåº” | ç”¨çš„äººè¶Šå¤šï¼Œäº§å“è¶Šå¥½ç”¨ |
| Switching Cost | è½¬æ¢æˆæœ¬ | ç”¨æˆ·æ¢åˆ°ç«å“æœ‰å¤šéº»çƒ¦ |
| Flywheel Effect | é£è½®æ•ˆåº” | ä¸€ä¸ªå¥½çš„å¾ªç¯è¶Šè½¬è¶Šå¿« |
| Recurring Revenue | ç»å¸¸æ€§æ”¶å…¥ | æ¯æœˆ/æ¯å¹´éƒ½ä¼šæ¥çš„ç¨³å®šæ”¶å…¥ |
| LTV / CAC | ç”¨æˆ·ç»ˆèº«ä»·å€¼ / è·å®¢æˆæœ¬ | ä¸€ä¸ªç”¨æˆ·å€¼å¤šå°‘é’± vs è·å¾—ä»–èŠ±å¤šå°‘é’± |
| Vertical Integration | å‚ç›´æ•´åˆ | ä¸Šä¸‹æ¸¸è‡ªå·±å¹²ï¼Œä¸é å¤–äºº |
| **å¸‚åœºå®šä»·æ¦‚å¿µ** | | |
| Priced In | å·²è¢«å®šä»· / å·²åæ˜ åœ¨è‚¡ä»·ä¸­ | èªæ˜é’±å·²ç»çŸ¥é“çš„ä¿¡æ¯ï¼Œè‚¡ä»·å·²ç»åŒ…å«äº† |
| Implied Growth Rate | éšå«å¢é•¿ç‡ | å½“å‰è‚¡ä»·å€’æ¨å‡ºæ¥çš„ã€å¸‚åœºè®¤ä¸ºçš„æœªæ¥å¢é•¿é€Ÿåº¦ |
| Reverse DCF | åå‘ç°é‡‘æµæŠ˜ç° | ä¸æ˜¯ç®—å…¬å¸å€¼å¤šå°‘ï¼Œè€Œæ˜¯çœ‹å½“å‰ä»·æ ¼åœ¨å‡è®¾ä»€ä¹ˆ |
| Consensus | å¸‚åœºå…±è¯† | å¤§å¤šæ•°åˆ†æå¸ˆçš„ä¸€è‡´çœ‹æ³•ï¼ˆé€šå¸¸å·²åæ˜ åœ¨è‚¡ä»·ä¸­ï¼‰ |
| Variant Perception | å·®å¼‚åŒ–è®¤çŸ¥ | ä½ å’Œå¸‚åœºçœ‹æ³•ä¸åŒçš„åœ°æ–¹â€”â€”è¿™æ‰æ˜¯èµšé’±çš„æ¥æº |
| Insider Buying | å†…éƒ¨äººä¹°å…¥ | å…¬å¸é«˜ç®¡ç”¨è‡ªå·±çš„é’±ä¹°è‡ªå®¶è‚¡ç¥¨ï¼ˆæœ€å¼ºä¿¡å·ä¹‹ä¸€ï¼‰ |
| Short Interest | åšç©ºæ¯”ä¾‹ | å¤šå°‘äººåœ¨èµŒè‚¡ä»·ä¸‹è·Œ |

---

## Report Styling Reference

Templates are in `src/`. Key styling rules shared across all templates:

- Self-contained: all CSS inline, no external dependencies
- Light background (#f8f9fa), max-width 900px, centered
- System font stack for clean reading
- Tables: alternating row colors, clean borders
- Print-friendly: `@media print` styles included (PDF export button auto-hidden)
- Floating "ğŸ“„ å¯¼å‡º PDF" button (bottom-right corner, hidden in print/PDF)
- Responsive: works on desktop and mobile

| Template | File | Header | Accent |
|---|---|---|---|
| è´¢æŠ¥è§£è¯» | `src/template.html` | Dark gradient (`#1a1a2e â†’ #16213e`) | Green/red metric borders |
| è´¢æŠ¥å‰ç» | `src/template.html` (modified) | Blue gradient (`#1a365d â†’ #2a4a7f`) | Blue metric borders |
| ä¼ä¸šç»è¥åˆ†æ | `src/template-analysis.html` | Purple gradient (`#2d1b69 â†’ #1a1a2e â†’ #16213e`) | Perspective accent colors |

Analysis template perspective accent colors:
- Observer: `#6b46c1` (purple)
- Strategist: `#2b6cb0` (blue)
- CEO: `#c05621` (amber)
- Investment: `#276749` (green)

---

## Important Notes

- **Language**: All report content MUST be in Chinese (Simplified). Only keep English for company names, tickers, and financial acronyms.
- **Data accuracy**: Always cite the source period and date. If data is uncertain, say so â€” never fabricate numbers.
- **Freshness**: Search for the most recent quarter's earnings. If the user specifies a quarter, search for that specific one.
- **Multiple sources**: Cross-reference at least 2 sources for key numbers (revenue, EPS).
- **Live data verification (CRITICAL)**: Before writing the final report, always run a dedicated search to verify real-time data points that change daily. Never rely on stale article data for these. Specifically:
  1. **Stock price**: Search `"[TICKER] stock price today"` to get the current price
  2. **Market cap**: Verify current market cap AND global/sector ranking (e.g., don't claim "å…¨çƒç¬¬ä¸€" without checking)
  3. **Key claims**: Any superlative claim ("æœ€å¤§", "ç¬¬ä¸€", "æœ€é«˜") must be verified against current data, not assumed from old articles
  4. If a fetched source shows data from more than 7 days ago, flag it and search for a fresher source
- If the user says just a company name with no other context, treat it as a request to generate an earnings report. However, if the most recent earnings have already been covered or the next earnings date is within ~3 weeks, ask whether they want è´¢æŠ¥è§£è¯», è´¢æŠ¥å‰ç», or ä¼ä¸šç»è¥åˆ†æ.
- If the user says "å‰ç» [company]", "[company] å‰ç»", or "[company] preview", treat it as a request to generate an earnings preview report.
- If the user says "åˆ†æ [company]", "[company] åˆ†æ", or "analyze [company]", treat it as a request to generate a four-perspective business analysis report.
